using UnityEngine;

public class PlayerShooting : MonoBehaviour
{
    public GameObject bulletPrefab; // 총알 Prefab
    public Transform shootingPoint; // 총알 발사 위치
    public float shootingForce = 10f; // 총알 발사 속도

    void Update()
    {
        // 'J' 키로 총 발사
        if (Input.GetKeyDown(KeyCode.J))
        {
            ShootBullet();
        }
    }

    void ShootBullet()
    {
        // 총알이 null인지 확인
        if (bulletPrefab != null && shootingPoint != null)
        {
            // 총알을 플레이어가 보고 있는 방향으로 발사
            GameObject bullet = Instantiate(bulletPrefab, shootingPoint.position, Quaternion.identity);

            // 총알 생성이 잘 되었는지 확인
            if (bullet != null)
            {
                Rigidbody2D bulletRb = bullet.GetComponent<Rigidbody2D>();
                if (bulletRb != null)
                {
                    // 총알을 오른쪽 또는 왼쪽으로 발사
                    Vector2 direction = transform.localScale.x > 0 ? Vector2.right : Vector2.left;
                    bulletRb.linearVelocity = direction * shootingForce;

                    // 총알의 발사자를 플레이어로 설정
                    Bullet bulletScript = bullet.GetComponent<Bullet>();
                    if (bulletScript != null)
                    {
                        bulletScript.shooter = gameObject; // 발사자를 플레이어로 설정
                    }
                }
                else
                {
                    Debug.LogError("Bullet does not have Rigidbody2D component!");
                }
            }
        }
        else
        {
            Debug.LogWarning("Bullet prefab or shooting point is missing.");
        }
    }
}
