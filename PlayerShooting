using UnityEngine;

public class PlayerShooting : MonoBehaviour
{
    public GameObject bulletPrefab; // 총알 Prefab
    public Transform shootingPoint; // 총알 발사 위치
    public float shootingForce = 10f; // 총알 발사 속도

    void Update()
    {
        // 'J' 키로 총 발사
        if (Input.GetKeyDown(KeyCode.J))
        {
            ShootBullet();
        }
    }

    void ShootBullet()
    {
        if (bulletPrefab == null || shootingPoint == null)
        {
            Debug.LogError("Bullet Prefab or Shooting Point is not set!");
            return; // bulletPrefab이나 shootingPoint가 없으면 발사하지 않음
        }

        // 총알을 클론 형태로 생성
        GameObject bullet = Instantiate(bulletPrefab, shootingPoint.position, shootingPoint.rotation);

        // 총알 생성이 정상적으로 되었는지 확인
        if (bullet != null)
        {
            Debug.Log("Bullet instantiated successfully!");
        }
        else
        {
            Debug.LogError("Bullet instantiation failed!");
        }

        Bullet bulletScript = bullet.GetComponent<Bullet>();

        if (bulletScript != null)
        {
            // 총알의 발사 방향 설정
            Vector2 direction = transform.localScale.x > 0 ? Vector2.right : Vector2.left;
            bulletScript.direction = direction; // 발사 방향 설정

            // 총알의 발사자 설정
            bulletScript.shooter = gameObject; // 발사자를 플레이어로 설정
        }
        else
        {
            Debug.LogError("Bullet prefab does not have a Bullet script attached!");
        }
    }
}
